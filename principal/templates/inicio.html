{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <title>Bienvenido a CardsRuns</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://kit.fontawesome.com/ae360af17e.js" crossorigin="anonymous"></script> 
        <link href="{% static 'css/style.css' %}" rel="stylesheet" >

    </head>
    <body>
        <div class="wrapper">
            <aside id="sidebar" class="js-sidebar">
                <!-- Content For Sidebar -->
                <div class="h-100">
                    <div class="sidebar-logo">
                        <a href="#">CardRuns</a>
                    </div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-header">
                            Panel de Usuario
                        </li>
                        <li class="sidebar-header">
                            <a href="#" class="sidebar-link">
                                <i class="fa-solid fa-list pe-2"></i>
                                Inicio
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a href="#" class="sidebar-link collapsed" data-bs-target="#auth" data-bs-toggle="collapse"
                                aria-expanded="false"><i class="fa-regular fa-user pe-2"></i>
                                Autenticación / Utilidades
                            </a>
                            <div>
                                <ul id="auth" class="sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                                    {% if usuario %}
                                    <li class="sidebar-header">
                                        Hola, {{ usuario.nombre }}. Ya te vas?
                                    </li>
                                    <li class="sidebar-item">
                                        <a href="{% url 'post_new' %}" class="sidebar-link">Crear Post</a>
                                    </li>
                                    <li class="sidebar-item">
                                        <a href="{% url 'usuario_logout' %}" class="sidebar-link">Cerrar Sesion</a>
                                    </li>
                                    {% else %}
                                    <li class="sidebar-item">
                                        <a href="{% url 'usuario_login' %}" class="sidebar-link">Iniciar Sesion</a>
                                    </li>
                                    <li class="sidebar-item">
                                        <a href="{% url 'registrar_usuario' %}" class="sidebar-link">Registrarse</a>
                                    </li>
                                    {% endif %}
                                </ul>  
                            </div>
                        </li>
                    </ul>
                </div>
            </aside>
            <div class="main">
                <nav class="navbar navbar-expand px-3 border-bottom">
                    <button class="btn" id="sidebar-toggle" type="button">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="navbar-collapse navbar">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                <a href="#" data-bs-toggle="dropdown" class="nav-icon pe-md-0">
                                    <img src="{% static 'image/profile.jpg' %}" class="avatar img-fluid rounded" alt="">
                                </a>
                                <div class="dropdown-menu dropdown-menu-end">
                                    {% if usuario %}
                                    <a href="#" class="dropdown-item">Disfruta CardRuns</a>
                                    <a href="{% url 'usuario_logout' %}" class="dropdown-item">Cerrar Sesion</a>
                                    {% else %}
                                    <a href="{% url 'usuario_login' %}" class="dropdown-item">Iniciar Sesion</a>
                                    <a href="{% url 'registrar_usuario' %}" class="dropdown-item">Registrarse</a>
                                    {% endif %}
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
                <main class="content px-3 py-2">
                    <div class="container-fluid">
                        <div class="mb-3">
                            <h4>Admin Dashboard</h4>
                        </div>
                        <div class="row">
                            <div class="col-12 col-md-6 d-flex">
                                <div class="card flex-fill border-0 illustration">
                                    <div class="card-body p-0 d-flex flex-fill">
                                        <div class="row g-0 w-100">
                                            <div class="col-6">
                                                <div class="p-3 m-1">
                                                    {% if usuario %}
                                                    <h4>Bienvenido, devuelta {{ usuario.nombre }}</h4>
                                                    <p class="mb-0">Prepara tu maso para la batalla!</p>
                                                    {% else %}
                                                    <h4>Inicia Sesión o Registrate!</h4>
                                                    <p class="mb-0">Tu mazo de cartas perfecto te espera!</p>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-6 align-self-end text-end">
                                                <img src="{% static "image/logo.png" %}" class="img-fluid illustration-img"
                                                    alt="">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-6 d-flex">
                                <div class="card flex-fill border-0">
                                    <div class="card-body py-4">
                                        <div class="d-flex align-items-start">
                                            <div class="flex-grow-1">
                                                <h4 class="mb-2">
                                                    Bienvenido a CardRuns
                                                </h4>
                                                <p class="mb-2">
                                                    Somos una pagina dedicada a el intercambio y venta de cartas(Trading Card Games)
                                                </p>
                                                <div class="mb-0">
                                                    <span class="badge text-success me-2">
                                                        Ahora nos encontramos Reservando y listando cartas
                                                    </span>
                                                    <br>
                                                    <span class="text-muted">
                                                        Atento a nuevas novedades!
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-inner">
                              <div class="carousel-item active">
                                <img src="{% static "image/tcgpt.webp" %}" class="d-block w-100" alt="">
                              </div>
                              <div class="carousel-item">
                                <img src="{% static "image/tcgpt1.webp" %}" class="d-block w-100" alt="">
                              </div>
                              <div class="carousel-item">
                                <img src="{% static "image/tcgpt2.webp" %}" class="d-block w-100" alt="">
                              </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
                              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
                              <span class="carousel-control-next-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Next</span>
                            </button>
                          </div>
                        <!-- Table Element -->
                        <div class="card border-0">
                            <div class="card-header">
                                <h5 class="card-title">
                                    Tablon de Publicaciones
                                </h5>
                                <h6 class="card-subtitle text-muted">
                                    Aqui puedes encontrar las mejores cartas Reservadas. No esta la tuya? Reservala!
                                </h6>
                            </div>                            
                            <div class="card-body">
                                <table class="table">
                                    <thead>
                                        <tr>                                        
                                            <th scope="col">Nombre Carta</th>
                                            <th scope="col">Categoria</th>
                                            <th scope="col">Descripcion</th>
                                            <th scope="col">Imagen</th>
                                            <th scope="col">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for post in posts %}
                                        <tr>
                                            <div>                                                
                                                {% if usuario %}                                                
                                                <td>{{ post.titulo}}</td>
                                                <td>{{ post.categoria}}</td>
                                                <td>{{ post.contenido}}</td>
                                                <td>
                                                    {% if post.imagen %}
                                                        <img src="{{ post.imagen.url }}" alt="{{ post.titulo }}" width="100">  <!-- Mostrar la imagen -->
                                                    {% else %}
                                                        No hay imagen
                                                    {% endif %}
                                                </td>
                                                <td><a href="{% url 'post_edit' post.pk %}">Modificar</a> / <a href="{% url 'post_delete' post.pk %}">Eliminar</a></td>
                                                {% else %} 
                                                
                                                <td>{{ post.titulo}}</td>
                                                <td>{{ post.categoria}}</td>
                                                <td>{{ post.contenido}}</td>
                                                <td>
                                                    {% if post.imagen %}
                                                        <img src="{{ post.imagen.url }}" alt="Imagen del post" width="100">  <!-- Mostrar la imagen -->
                                                    {% else %}
                                                        No hay imagen
                                                    {% endif %}
                                                </td>
                                                <td>Inicia Sesion para Realizar Cambios</td>
                                                {% endif %}
                                            </div>
                                            {% endfor%}
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </main>
                <a href="#" class="theme-toggle">
                    <i class="fa-regular fa-moon"></i>
                    <i class="fa-regular fa-sun"></i>
                </a>
                <footer class="footer">
                    <div class="container-fluid">
                        <div class="row text-muted">
                            <div class="col-6 text-start">
                                <p class="mb-0">
                                    <a href="#" class="text-muted">
                                        <strong>CardRuns</strong>
                                    </a>
                                </p>
                            </div>
                            <div class="col-6 text-end">
                                <ul class="list-inline">
                                    <li class="list-inline-item">
                                        <a href="#" class="text-muted">Aun nos encontramos en construccion! , atento a nuevas novedades</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <script>
            function confirmarEliminar(postId) {
                if (confirm("¿Estás seguro de que quieres eliminar este post?")) {
                    window.location.href = `/post/${postId}/eliminar/`;
                }
            }
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script src="{% static 'js/script.js' %}"></script>
    </body>
</html>